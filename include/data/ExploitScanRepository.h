#ifndef INSIDE_EXPLOITSCANREPOSITORY_H
#define INSIDE_EXPLOITSCANREPOSITORY_H

#include <mariadb/conncpp.hpp>
#include <nlohmann/json.hpp>

struct ExploitScan {
    int id{};
    std::string activityType;
    std::string activityTarget;
    std::string activityDate;
    bool exploited;
};

void to_json(nlohmann::json& j, const ExploitScan& v);

class ExploitScanRepository {
public:
    static std::vector<ExploitScan> selectFromActivitiesTable(const std::unique_ptr<sql::Connection>& connection);
    static void createExploitScanRegister(const std::unique_ptr<sql::Connection>& connection,
                                                std::string &ip, std::string &activityType, bool &exploitResult);
    static int selectCountExploits(const std::unique_ptr<sql::Connection>& connection);
    static int selectCountScans(const std::unique_ptr<sql::Connection>& connection);
};

#endif
