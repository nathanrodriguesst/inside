#include "../include/exploit/Exploit.h"
#include "utils/CommandLineExecute.h"

Exploit::Exploit() = default;


std::string Exploit::exploitVulnerableServices (std::vector<std::string> &vulnerableServices, std::string &target)
{
    std::string command;

    for (const auto& service : vulnerableServices) {
        std::string exploitScriptPath = "../resources/scripts/ftp.sh";

        if (service == "vsftpd 2.3.4") {
            command.append(exploitScriptPath).append(" ").append(target);
            return CommandLineExecute::executeCommand(command.c_str());
        }
    }
    return "";
}