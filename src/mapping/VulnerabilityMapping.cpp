#include "../include/mapping/VulnerabilityMapping.h"
#include <iostream>
#include <set>

VulnerabilityMapping::VulnerabilityMapping() {
    knownVulnerableServices = {
        "Apache httpd 2.4.29", "MySQL 5.7.25-0ubuntu0.16.04.2", "Squid http proxy 3.5.27"
    };
}

std::vector<std::string> VulnerabilityMapping::findVulnerableServices(const std::vector<ScanResult>& parsedScanVector) {
    std::vector<std::string> vulnerableServices;

    for (const auto &result : parsedScanVector) {
        std::cout << result.version << std::endl;
        if (knownVulnerableServices.find(result.version) != knownVulnerableServices.end()) {
            vulnerableServices.push_back(result.version);
        }
    }

    return vulnerableServices;
}